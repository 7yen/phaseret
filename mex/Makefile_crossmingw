
outdir = /home/susnak/Dropbox/phaseret_win64/mex
export CROSS=x86_64-w64-mingw32.shared-
export MINGW=1
export NOBLASLAPACK=1
export EXT=mexw64
MEXDIR = /home/susnak/Dropbox/win64libs

all: libltfat libphaseret fftw mex

libltfat:
	make -C ../libltfat shared
	mkdir -p $(outdir)
	cp ../libltfat/build/$(CROSS)/libltfatd.* $(outdir)

libphaseret:
	make -C ../libphaseret shared OPTLFLAGS=-L../libltfat/build/$(CROSS)
	mkdir -p $(outdir)
	cp ../libphaseret/build/$(CROSS)/libphaseretd.* $(outdir)

fftw:
	cp $(MEXDIR)/libfftw3-*.dll $(outdir)

mex:
	make -f Makefile_mingw MEXCOMPFLAGS="-I$(MEXDIR)" MEXLINKFLAGS="-L$(MEXDIR) -lmex -lmx -L$(outdir)"
	cp *.$(EXT) $(outdir)

clean:
	make -C ../libltfat clean
	make -C ../libphaseret clean
	-rm *.o
	-rm *.$(EXT)


